# cvdupdate + freshclam

This container image serves as a [private local mirror][mirror] for [ClamAV][clamav].
It uses [`freshclam`][freshclam] to periodically fetch updates from official
sources, and it uses [`cvdupdate`][cvdupdate] to serve them over `http` on port `8000`.
Signature are configured to be downloaded to and served from `/opt/cvd` within
the container. This is to more easily mount volumes for persistence.

## Build Locally

```
docker build -t my-mirror .
docker run -p 8000:8000 my-mirror:latest
```

### Test

```sh
curl localhost:8000/bytecode.cvd --output bytecode.cvd
```


## Config

The default port can be changed within `run.sh` by adding a port number after
the `cvdupdate` command:

```sh
cvdupdate serve 80
```

[clamav]: https://www.clamav.net/
[mirror]: https://docs.clamav.net/appendix/CvdPrivateMirror.html
[freshclam]: https://linux.die.net/man/1/freshclam
[cvdupdate]: https://github.com/Cisco-Talos/cvdupdate
